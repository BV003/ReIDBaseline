==========
Args:Namespace(config_file='vit_base_ics_288.yml', opts=[], dataset='regdb_rgb', batch_size=64, workers=4, height=288, width=144, num_instances=16, eps=0.6, eps_gap=0.02, k1=3, k2=1, arch='agw', features=0, dropout=0, momentum=0.99, trial=1, lr=0.00035, weight_decay=0.0005, epochs=1, iters=50, step_size=20, seed=1, print_freq=10, eval_step=1, temp=0.05, data_dir='/data2/liuweiqi/home/project1/ReIDBaseline/data', logs_dir='./logs/regdb_train/1', pooling_type='gem', use_hard=False, no_cam=False, warmup_step=0, milestones=[20, 40])
==========
Loaded configuration file vit_base_ics_288.yml

MODEL:
  PRETRAIN_PATH: '../vit_base_ics_cfs_lup.pth'
  PRETRAIN_HW_RATIO: 2
  METRIC_LOSS_TYPE: 'triplet'
  IF_LABELSMOOTH: 'off'
  IF_WITH_CENTER: 'no'
  NAME: 'transformer'
  NO_MARGIN: True
  # DEVICE_ID: ('3')
  TRANSFORMER_TYPE: 'vit_base_patch16_224_TransReID'
  STRIDE_SIZE: [16, 16]
  STEM_CONV: True # False for vanilla ViT-S
  GEM_POOLING: False
  # DIST_TRAIN: True
  SIE_COE: 3.0
INPUT:
  SIZE_TRAIN: [288, 144] #[384, 128] #[288, 144] #
  SIZE_TEST: [288, 144] # [384, 128] #  [288, 144] #
  PROB: 0.5 # random horizontal flip
  RE_PROB: 0.5 # random erasing
  PADDING: 10
  PIXEL_MEAN: [0.5, 0.5, 0.5]
  PIXEL_STD: [0.5, 0.5, 0.5]

# DATASETS:
#   NAMES: ('market1501')
#   ROOT_DIR: ('/home/michuan.lh/datasets')

# DATALOADER:
#   SAMPLER: 'softmax_triplet'
#   NUM_INSTANCE: 4
#   NUM_WORKERS: 8

SOLVER:
  OPTIMIZER_NAME: 'SGD'
  MAX_EPOCHS: 120
  BASE_LR: 0.0004
  WARMUP_EPOCHS: 20
  IMS_PER_BATCH: 64
  WARMUP_METHOD: 'cosine'
  LARGE_FC_LR: False
  CHECKPOINT_PERIOD: 120
  LOG_PERIOD: 20
  EVAL_PERIOD: 120
  WEIGHT_DECAY:  1e-4
  WEIGHT_DECAY_BIAS: 1e-4
  BIAS_LR_FACTOR: 2

TEST:
  EVAL: True
  IMS_PER_BATCH: 256
  RE_RANKING: False
  WEIGHT: ''
  NECK_FEAT: 'before'
  FEAT_NORM: 'yes'

# OUTPUT_DIR: '../../log/transreid/market/vit_base_ics_cfs_lup_384'

==> Load unlabeled dataset
=> regdb_ir loaded 1
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   200 |      200 |         1
  query    |   191 |      191 |         1
  gallery  |   191 |      191 |         1
  ----------------------------------------
=> regdb_rgb loaded 1
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   200 |      400 |         1
  query    |   191 |      382 |         1
  gallery  |   191 |      382 |         1
  ----------------------------------------
using Transformer_type: vit_base_patch16_224_TransReID as a backbone
using stride: [16, 16], and patch number is num_y18 * num_x9
using stride: [16, 16], and patch number is num_y18 * num_x9
Resized position embedding from size:torch.Size([1, 129, 768]) to size: torch.Size([1, 163, 768]) with height:18 width: 9
Load 172 / 203 layers.
===========building transformer===========
None
IR Clustering criterion: eps: 0.300
RGB Clustering criterion: eps: 0.300
==> Create pseudo labels for unlabeled RGB data
total time: 0.050656795501708984
==> Create pseudo labels for unlabeled IR data
total time: 0.04152536392211914
Computing jaccard distance...
Jaccard distance computing time cost: 0.37482237815856934
Computing jaccard distance...
Jaccard distance computing time cost: 0.20609426498413086
args.momentum 0.99
==> Statistics for RGB epoch 0: 18 clusters outlier 363 
==> Statistics for IR epoch 0: 167 clusters outlier 0 
